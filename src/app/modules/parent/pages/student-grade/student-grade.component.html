<main>
  <div class="table">
    <div class="error-container" *ngIf="!show">
      Grades update coming soon! Keep an eye out for the latest results
    </div>
    <div class="table-header" *ngIf="show">
      <div class="btn-container">
        <button class="edit table-header-btn" title="Back" (click)="onBack()">
          <span class="material-symbols-rounded table-header-icon">
            arrow_back
          </span>
        </button>
        <button
          class="reset table-header-btn"
          title="Reset"
          (click)="onReset()"
        >
          <span class="material-symbols-rounded table-header-icon">
            restart_alt
          </span>
        </button>
      </div>
      <div class="filter">
        <p-dropdown
          [options]="schoolYears"
          placeholder="Filter by year and term"
          appendTo="body"
          [style]="{
            width: '100%',
            minWidth: '16rem',
          }"
          [(ngModel)]="schoolYear"
          (ngModelChange)="onChangeSchoolYear($event)"
        ></p-dropdown>
      </div>
    </div>
    <div class="units-container" *ngIf="show">
      <div class="selected-unit">GWA: {{ GWA }}</div>
      <div class="minimum-unit">Commulative GWA: {{ cummulativeGWA }}</div>
    </div>
    <div class="card-container">
      <ng-container *ngFor="let grade of grades">
        <div class="card" *ngIf="grade.dateModified">
          <div class="card-header">
            <div class="title">{{ grade.subject.subjectTitle }}</div>
            <div class="subtitle">
              {{ grade.professor.fullname }} -
              {{ convertDate(grade.dateModified) }}
            </div>
          </div>
          <div class="card-body">
            <div class="card-head">
              <div class="grade-title">PRELIM</div>
              <div class="grade-title">MIDTERM</div>
              <div class="grade-title">FINALS</div>
            </div>
            <div class="card-content">
              <div class="grade">{{ convertGrade(grade.prelim) }}</div>
              <div class="grade">{{ convertGrade(grade.midterm) }}</div>
              <div class="grade">{{ convertGrade(grade.finals) }}</div>
            </div>
          </div>
          <div class="card-footer">
            <div class="final">Final Grade</div>
            <div class="grade">
              {{ getAverage(grade.prelim, grade.midterm, grade.finals) }}
            </div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</main>
